---
title: 浏览器渲染原理
date: 2021-06-02 11:29:57
tags:
---

### 进程和线程

进程：进程是计算机中程序关于某数据集合上的一次运行活动，是系统进行资源分配和调度的基本单位。
线程：线程是操作系统能够进行运算调度的最小单位，线程可以与同一个进程的其他线程共享进程所拥有的全部资源。

## 浏览器是多进程

以Chrome 为例，主要的进程有4个
1.浏览器进程（Browser Process）负责浏览器的Tab的前进、后退、地址栏、书签栏的工作和处理浏览器一些不可见的底层操作，比如网络请求和文件访问。
2.渲染进程（Renderer Process） 负责一个Tab内的显示相关的工作，也称渲染引擎。
3.插件进程（Plugin Process）负责控制网页使用到的插件
4.GPU进程 （GPU Process) 负责处理整个应用程序的GPU任务

### 浏览器渲染进程

1.一个主线程（main thread）
2.多个工作线程（worker threads）
3.一个合成线程（compositor thread）
4.一个光栅线程（raster thread）

### 构建DOM

### 子资源加载

### 样式计算

### 布局 Layout

### 绘画 Paint

### 合成

合成是将页面分成若干层，然后分别对他们进行光栅化，最后在一个单独的线程（合成线程）里面合成一个页面的技术。


### 当你写事件监听器的时候留点心眼

Web开发的一个常见的模式是事件委托（event delegation）。由于事件会冒泡，你可以给顶层的元素绑定一个事件监听函数来作为其所有子元素的事件委托者，这样子节点的事件就可以统一被顶层的元素处理了。
为了减轻这种情况的发生，您可以为事件监听器传递passive：true选项。 这个选项会告诉浏览器您仍要在主线程中侦听事件，可是合成线程也可以继续合成新的帧。

```
document.body.addEventListener('touchstart', event => {
   if (event.target === area) {
       event.preventDefault()
   }
}, {passive: true});
```